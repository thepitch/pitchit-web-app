
<div class="profile-header">
  <% if current_user == @user %>
    <h1>Your Profile</h1>
  <% end %>

  <div class="row">
    <% if @user.picture_url %>
      <div class="four columns avatar">
        <img src=<%= @user.picture_url %> class="avatar-photo">
      </div>
    <% end %>
    <div class="eight columns">
      <div class="row">
        <h1><%= @user.full_name %></h1>
        <% if @user.user_type %>
          <h4><%= @user.first_name %> is a <%= @user.user_type %></h4>
        <% end %>
        <p><%= @user.blurb || "This user does not have a blurb yet." %></p>
      </div>
    </div>
  </div>
</div>
<% if current_user %>
  <div class="contact">
    <h4>Click for Contact Information</h4>
    <ul class="contact-list">
      <%= raw("<li>Phone: #{@user.phone}</li>") if @user.phone %>
      <%= raw("<li>Email: #{@user.email}</li>") if @user.email %>
      <%= raw("<li>Company: #{@user.company}</li>") if @user.company %>
    </ul>
  </div>
<% end %>

  <% if @user.pitches.count > 0 %>
    <table class="user-pitches">
      <thead>
        <td>Pitches</td>
        <td class="votes-heading">Votes</td>
      </thead>
      <% @user.pitches.order(created_at: :desc).each do |pitch| %>
      <tr>
        <td><p><h3><%= link_to "#{pitch.title}", pitch_path(pitch.id) %></h3><br><em><%= pitch.tagline %></em></p></td>
        <td class="vote-count"><%= pitch.votes.count %></td>
      </tr>
      <% end %>
    </table>
  <% else %>
    <p>No pitches.</p>
  <% end %>

  <% if @user.comments.count > 0 %>
    <table class="user-comments">
      <thead>
        <td>Comments</td>
        <td class="votes-heading">Votes</td>
      </thead>
      <% @user.comments.order(created_at: :desc).each do |comment| %>
      <tr>
        <td><p><%= link_to "#{comment.pitch.title}", pitch_path(comment.pitch_id) %><br><%= comment.content %> </p></td>
        <td class="vote-count"><%= comment.votes.count %></td>
      </tr>
      <% end %>
    </table>
  <% else %>
    <p>No comments.</p>
  <% end %>

<% if current_user == @user %>
  <table class="user-bookmarks">
    <thead>
      <td>Your Bookmarks</td>
    </thead>
    <% @user.votes.select(&:bookmarked).each do |vote| %>
      <tr>
        <% if vote.votable_type == "Pitch" %>
          <td><p><%= link_to "#{vote.votable.title}", pitch_path(vote.votable) %><br><em><%= vote.votable.tagline %></em></p></td>
        <% else %>
          <td><p><%= link_to "#{vote.votable.pitch.title}", pitch_path(vote.votable.pitch) %><br><%= vote.votable.content %> </p></td>
        <% end %>
      </tr>
    <% end %>
  </div>
<% end %>
